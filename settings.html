<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Settings â€” Ragelite</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Inter,Arial,sans-serif;
  background:#050b14;
  color:#eaf2ff;
}

.container{
  max-width:520px;
  margin:80px auto;
  background:#0b1b33;
  padding:32px;
  border-radius:18px;
  border:1px solid #1f2937;
}

h1{margin-top:0}

label{
  display:block;
  margin-top:18px;
  font-size:14px;
  color:#9fb3d1;
}

input{
  width:100%;
  margin-top:6px;
  padding:12px;
  border-radius:10px;
  border:1px solid #1f2937;
  background:#071225;
  color:#eaf2ff;
}

button{
  margin-top:24px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-weight:700;
  background:linear-gradient(90deg,#22d3ee,#3b82f6);
  color:#020617;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="container">
  <h1>Settings</h1>

  <label>Username</label>
  <input id="usernameInput" placeholder="Your username">

  <label>Avatar URL (optional)</label>
  <input id="avatarInput" placeholder="https://...">

  <button onclick="saveSettings()">Save Changes</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDDEuW9B7CdfVXslSMvxFBRVPIlcFjHqXs",
  authDomain: "rageauth-174a5.firebaseapp.com",
  projectId: "rageauth-174a5",
  appId: "1:485170234605:web:2cd934b30ab0de678f38e4"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let userRef;

onAuthStateChanged(auth, async (user) => {
  if (!user) {
    location.href = "index.html";
    return;
  }

  userRef = doc(db, "users", user.uid);
  const snap = await getDoc(userRef);

  if (snap.exists()) {
    const data = snap.data();
    document.getElementById("usernameInput").value = data.username || "";
    document.getElementById("avatarInput").value = data.avatar || "";
  }
});

window.saveSettings = async () => {
  const username = document.getElementById("usernameInput").value.trim();
  const avatar = document.getElementById("avatarInput").value.trim();

  await updateDoc(userRef, {
    username,
    avatar
  });

  alert("Settings saved");
  location.href = "dashboard.html";
};
</script>

</body>
</html>
